<div class="w-full max-w-5xl lg:grid lg:grid-cols-2 lg:shadow-xl lg:rounded-2xl overflow-hidden bg-white">
  <!-- Coluna da Esquerda (Branding - Apenas Desktop) -->
  <div class="hidden lg:flex flex-col items-center justify-center p-12 bg-teal-50 text-center">
    <svg class="w-20 h-20 text-teal-500 mb-4" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
    </svg>
    <h1 class="text-3xl font-bold text-gray-800">Lunen EMR</h1>
    <p class="text-gray-600 mt-2">Segurança e confiança no acesso aos seus dados.</p>
    <img src="https://storage.googleapis.com/aistudio-hosting/general/619736c5-e6f8-4b71-aa34-b25dd6729094.png" alt="Ilustração de segurança" class="mt-8 w-full max-w-sm h-auto" />
  </div>

  <!-- Coluna da Direita (Formulário) -->
  <div class="p-8 sm:p-12 flex flex-col justify-center">
    <div class="lg:hidden text-center mb-8">
       <img src="https://storage.googleapis.com/aistudio-hosting/general/619736c5-e6f8-4b71-aa34-b25dd6729094.png" alt="Ilustração de segurança" class="w-48 h-auto mx-auto mb-4" />
    </div>
    
    <form [formGroup]="passwordForm" (ngSubmit)="handleSavePassword()" class="w-full max-w-sm mx-auto">
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Criar Nova Senha</h2>
      <p class="text-gray-500 mb-6">Sua nova senha deve ser forte e diferente da anterior.</p>
      
      <!-- Nova Senha -->
      <div class="mb-4">
        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Nova Senha</label>
        <div class="relative">
          <input [type]="isPasswordVisible() ? 'text' : 'password'" id="password" formControlName="password"
                 [class]="'w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 ' + 
                 (passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched ? 'border-red-500 ring-red-200' : 'border-gray-300 focus:ring-teal-200 focus:border-teal-500')">
          <button type="button" (click)="togglePasswordVisibility()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
            @if(isPasswordVisible()){
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
            } @else {
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" /></svg>
            }
          </button>
        </div>
        @if(passwordForm.get('password')?.hasError('minlength') && passwordForm.get('password')?.touched) {
          <p class="text-xs text-red-600 mt-1">A senha deve ter no mínimo 8 caracteres.</p>
        }
      </div>

      <!-- Password Strength Indicator -->
      @if (passwordForm.get('password')?.value) {
        <div class="flex items-center space-x-2 mb-4">
          <div class="flex-1 h-1.5 rounded-full" [class]="passwordStrength() >= 1 ? 'bg-red-500' : 'bg-gray-200'"></div>
          <div class="flex-1 h-1.5 rounded-full" [class]="passwordStrength() >= 2 ? 'bg-yellow-500' : 'bg-gray-200'"></div>
          <div class="flex-1 h-1.5 rounded-full" [class]="passwordStrength() >= 3 ? 'bg-teal-500' : 'bg-gray-200'"></div>
          <div class="flex-1 h-1.5 rounded-full" [class]="passwordStrength() >= 4 ? 'bg-green-500' : 'bg-gray-200'"></div>
          <span class="text-xs font-medium" 
                [class]="{
                  'text-red-600': passwordStrength() === 1,
                  'text-yellow-600': passwordStrength() === 2,
                  'text-teal-600': passwordStrength() === 3,
                  'text-green-600': passwordStrength() === 4
                }">
                @switch(passwordStrength()) {
                  @case(1) { Fraca }
                  @case(2) { Média }
                  @case(3) { Forte }
                  @case(4) { Muito Forte }
                }
          </span>
        </div>
      }
      
      <!-- Confirmar Senha -->
      <div class="mb-6">
        <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirmar Nova Senha</label>
        <div class="relative">
          <input [type]="isConfirmPasswordVisible() ? 'text' : 'password'" id="confirmPassword" formControlName="confirmPassword"
                 [class]="'w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 ' + 
                 (passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched ? 'border-red-500 ring-red-200' : 'border-gray-300 focus:ring-teal-200 focus:border-teal-500')">
          <button type="button" (click)="toggleConfirmPasswordVisibility()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
             @if(isConfirmPasswordVisible()){
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
            } @else {
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" /></svg>
            }
          </button>
        </div>
         @if(passwordForm.hasError('passwordsNotMatching') && passwordForm.get('confirmPassword')?.touched) {
          <p class="text-xs text-red-600 mt-1">As senhas não coincidem.</p>
        }
      </div>
      
      <!-- Submit -->
      <button type="submit" [disabled]="passwordForm.invalid" class="w-full px-6 py-3 text-base font-semibold text-white bg-teal-500 rounded-lg shadow-sm hover:bg-teal-600 transition-colors disabled:bg-teal-300 disabled:cursor-not-allowed">
        Salvar Nova Senha
      </button>

      <p class="text-sm text-center text-gray-500 mt-6">
        Lembrou a senha? <a routerLink="/login" class="font-semibold text-teal-600 hover:underline">Voltar para o login</a>
      </p>
    </form>
  </div>
</div>
