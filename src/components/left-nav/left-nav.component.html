<div [class]="'flex flex-col h-full bg-white text-gray-700 transition-all duration-300 border-r border-gray-200 ' + (isCollapsed() ? 'w-20' : 'w-64')">
  <!-- Logo -->
  <div class="flex items-center h-20 border-b border-gray-200" [class.justify-center]="isCollapsed()" [class.px-4]="!isCollapsed()">
    <svg class="h-8 w-auto text-sky-500 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
    </svg>
    @if (!isCollapsed()) {
      <h1 class="ml-3 text-xl font-semibold text-slate-800 whitespace-nowrap">MedNatal</h1>
    }
  </div>

  <!-- User Info -->
  <div class="hidden flex flex-col items-center border-b border-gray-200 transition-all duration-300" [class]="isCollapsed() ? 'p-4' : 'p-6'">
    <img [src]="doctor().avatarUrl" alt="Foto do Doutor" class="rounded-full object-cover border-2 border-sky-400 transition-all duration-300" [class]="isCollapsed() ? 'w-12 h-12' : 'w-20 h-20'">
    @if (!isCollapsed()) {
      <span class="font-medium text-slate-800 text-center whitespace-nowrap mt-3">{{ doctor().name }}</span>
    }
  </div>

  <!-- Navigation -->
  <nav class="flex-1 px-2 py-2 space-y-2">
    @for(item of navItems(); track item.label) {
      <a [routerLink]="item.path !== '#' ? item.path : null"
         routerLinkActive="bg-[rgba(234,244,252,1)] text-[rgba(21,87,185,1)] font-bold"
         #rla="routerLinkActive"
         [title]="isCollapsed() ? item.label : ''"
         [class.pointer-events-none]="item.path === '#'"
         [class.opacity-50]="item.path === '#'"
         class="flex items-center py-2.5 rounded-lg transition-colors duration-200"
         [class]="isCollapsed() ? 'justify-center' : 'px-4'"
         [class.hover:bg-gray-100]="!rla.isActive"
         [class.hover:text-gray-800]="!rla.isActive">
        
        <span class="flex-shrink-0" [class.mr-3]="!isCollapsed()" [innerHTML]="getSafeIconHtml(item.icon)"></span>
        @if (!isCollapsed()) {
          <span class="whitespace-nowrap">{{ item.label }}</span>
        }
      </a>
    }
  </nav>

  <!-- Footer Actions -->
  <div class="p-4 border-t border-gray-200">
    <div class="space-y-2">
        <!-- Collapse Button -->
        <button (click)="onToggleNav()" [title]="isCollapsed() ? 'Expandir menu' : 'Recolher menu'" class="w-full flex items-center py-2.5 rounded-lg transition-colors duration-200 hover:bg-gray-100 hover:text-gray-800" [class]="isCollapsed() ? 'justify-center' : 'px-4'">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 flex-shrink-0 transition-transform duration-300" [class.rotate-180]="isCollapsed()">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
            </svg>
            @if (!isCollapsed()) {
                <span class="ml-3 whitespace-nowrap">Recolher</span>
            }
        </button>

        <!-- Logout Button -->
        <a href="#" title="Sair" class="w-full flex items-center py-2.5 rounded-lg transition-colors duration-200 hover:bg-gray-100 hover:text-gray-800" [class]="isCollapsed() ? 'justify-center' : 'px-4'">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 flex-shrink-0">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
            </svg>
            @if (!isCollapsed()) {
                <span class="ml-3 whitespace-nowrap">Sair</span>
            }
        </a>
    </div>
  </div>
</div>